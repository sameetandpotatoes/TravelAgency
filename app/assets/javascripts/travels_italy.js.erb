<% current_dest = 'Italy' %>
var dest_1 = "<%= INFO[current_dest]['cities'][0]['name'].downcase.gsub(/\s+/, '') %>";
var dest_2 = "<%= INFO[current_dest]['cities'][1]['name'].downcase.gsub(/\s+/, '') %>";
var dest_3 = "<%= INFO[current_dest]['cities'][2]['name'].downcase.gsub(/\s+/, '') %>";
var map;

var coords = [<%= INFO[current_dest]['cities'][0]['location'] %>, <%= INFO[current_dest]['cities'][1]['location'] %>, <%= INFO[current_dest]['cities'][2]['location'] %>];
var titles = ["<%= INFO[current_dest]['cities'][0]['name'] %>", "<%= INFO[current_dest]['cities'][1]['name'] %>", "<%= INFO[current_dest]['cities'][2]['name'] %>"];
var desc = ['desc-1', 'desc-2', 'desc-3'];
var colors = ['#f86767','#f86767','#f86767'];

function initialize_map(){
  L.mapbox.accessToken = "<%= ENV['MAPBOX_ACCESS'] %>";
  map = L.mapbox.map('hawaii-map', "<%= ENV['MAPBOX_MAP'] %>");
  map.setView(<%= INFO[current_dest]['location'] %>, 5);
  // map.dragging.disable();
  map.touchZoom.disable();
  map.doubleClickZoom.disable();
  map.scrollWheelZoom.disable();
  if (map.tap) map.tap.disable();
}

function overlay_markers(){
  for (var i = 0; i < 3; i++){
    L.mapbox.featureLayer({
      type: 'Feature',
      geometry: {
        type: 'Point',
        coordinates: coords[i]
      },
      properties: {
        title: titles[i],
        dest: desc[i],
        'marker-color': colors[i]
      }
    }).addTo(map).on('click', mapClickHandler);
  }
}

function mapClickHandler(e){
  var allDesc =$('.descriptions').children();
  for (var i = 0; i < allDesc.length; i++){
    $(allDesc[i]).css('display','none');
  }
  // console.log(e.layer.feature.properties['dest']);
  $('.'+e.layer.feature.properties['dest']).css('display','block');
}

initialize_map();
overlay_markers();
